<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Capsule Documentation — Ato Store</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:opsz,wght@9..40,400;9..40,500;9..40,600;9..40,700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./docs.css">
</head>
<body>
  <!-- Navigation -->
  <nav class="fixed top-0 left-0 right-0 z-50 border-b border-[var(--border)]">
    <div class="max-w-6xl mx-auto px-6 h-16 flex items-center justify-between">
      <div class="flex items-center gap-8">
        <a href="./index.html" class="flex items-center gap-2 font-semibold text-lg">
          <picture>
            <source srcset="/icon-dark.svg" media="(prefers-color-scheme: dark)" type="image/svg+xml">
            <img src="/favicon.svg" width="28" height="28" alt="Ato Store">
          </picture>
          <span>Ato Store</span>
        </a>
        <div class="hidden md:flex items-center gap-6">
          <a href="./index.html" class="text-sm text-[var(--fg-secondary)] hover:text-[var(--fg)] transition-colors">Docs</a>
          <a href="./getting-started.html" class="text-sm text-[var(--fg-secondary)] hover:text-[var(--fg)] transition-colors">Getting Started</a>
          <a href="./cli-reference.html" class="text-sm text-[var(--fg-secondary)] hover:text-[var(--fg)] transition-colors">CLI</a>
        </div>
      </div>
      <div class="flex items-center gap-3">
        <a href="./future-roadmap.html" class="text-sm font-medium text-[var(--fg-secondary)] hover:text-[var(--fg)] transition-colors">Sign In</a>
        <a href="./publish-guideline.html" class="bg-[var(--bg-strong)] text-white text-sm font-medium px-4 py-2 rounded-lg hover:bg-[#262626] transition-colors">Publish</a>
      </div>
    </div>
  </nav>

  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="sidebar-section">
      <div class="sidebar-title">Documentation</div>
      <a href="./index.html" class="sidebar-link active">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
        Overview
      </a>
      <a href="./getting-started.html" class="sidebar-link">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="4 17 10 11 4 5"/><line x1="12" y1="19" x2="20" y2="19"/></svg>
        Getting Started
      </a>
      <a href="./core-concepts.html" class="sidebar-link">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/></svg>
        Core Concepts
      </a>
      <a href="./cli-reference.html" class="sidebar-link">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><line x1="9" y1="9" x2="15" y2="15"/><line x1="15" y1="9" x2="9" y2="15"/></svg>
        CLI Reference
      </a>
      <a href="./publish-guideline.html" class="sidebar-link">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21.2 8.4c.5.38.8.97.8 1.6v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V10a2 2 0 0 1 .8-1.6l8-6a2 2 0 0 1 2.4 0l8 6Z"/><path d="m22 10-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 10"/></svg>
        Publish Guideline
      </a>
      <a href="./future-roadmap.html" class="sidebar-link">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
        Future Roadmap
      </a>
    </div>

    <div class="sidebar-section">
      <div class="sidebar-title">Specs</div>
      <a href="../../docs/specs/README.md" class="sidebar-link">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
        README.md
      </a>
      <a href="../../docs/specs/CAPSULE_CLI_SPEC.md" class="sidebar-link">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
        CLI Spec
      </a>
      <a href="../../docs/specs/DRAFT_LIFECYCLE.md" class="sidebar-link">
        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
        Lifecycle
      </a>
    </div>
  </aside>

  <!-- Main Content -->
  <div class="docs-content">
    <main class="docs-body">
      <article class="prose animate-fade-up">
        <h1>Capsule Documentation</h1>
        <p class="lead">
          このドキュメント群は <code>/docs/specs</code> の仕様を一次情報として、
          実装の現状と今後の移行計画を同じ前提で参照できるように整理しています。
        </p>

        <div class="quick-nav">
          <a href="#how-to-read" class="quick-nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
            読み方
          </a>
          <a href="#spec-status" class="quick-nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
            仕様ステータス
          </a>
          <a href="#architecture-boundary" class="quick-nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
            責務境界
          </a>
          <a href="#doc-map" class="quick-nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="3 11 22 2 13 21 11 13 3 11"/></svg>
            ページ一覧
          </a>
        </div>

        <h2 id="how-to-read">このドキュメントの読み方</h2>
        <p>
          まず <a href="./getting-started.html">Getting Started</a> で最小手順を確認し、
          次に <a href="./core-concepts.html">Core Concepts</a> で実行モデルを理解してください。
          コマンド仕様は <a href="./cli-reference.html">CLI Reference</a>、配布手順は
          <a href="./publish-guideline.html">Publish Guideline</a> に分離しています。
        </p>

        <div class="info-box">
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <line x1="12" y1="16" x2="12" y2="12"/>
            <line x1="12" y1="8" x2="12.01" y2="8"/>
          </svg>
          <div class="content">
            <div class="title">方針</div>
            <p>
              仕様の最新更新日は 2026年2月7日（<code>docs/specs/README.md</code>）。
              実装済み/未実装は各Specの「実装状況」表を優先し、本ページでは要点のみ要約します。
            </p>
          </div>
        </div>

        <h2 id="spec-status">主要Specのステータス</h2>
        <table>
          <thead>
            <tr>
              <th>Spec</th>
              <th>状態</th>
              <th>要点</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>CAPSULE_CLI_SPEC.md</code></td>
              <td><span class="badge ok">v0.3</span></td>
              <td><code>capsule</code> が IPC Broker を担当（nacelleから移管）</td>
            </tr>
            <tr>
              <td><code>NACELLE_SPEC.md</code></td>
              <td><span class="badge ok">v0.3</span></td>
              <td>Source Runtime + Sandbox Enforcer に責務を集中</td>
            </tr>
            <tr>
              <td><code>DESKTOP_SPEC.md</code></td>
              <td><span class="badge ok">v0.3</span></td>
              <td>Guest Host / User Consent / Deep Link UI</td>
            </tr>
            <tr>
              <td><code>DRAFT_LIFECYCLE.md</code></td>
              <td><span class="badge ok">v1.2 Accepted</span></td>
              <td><code>[tasks]</code> と <code>[services]</code> の分離 + DAG実行</td>
            </tr>
            <tr>
              <td><code>DRAFT_CAPSULE_IPC.md</code></td>
              <td><span class="badge ok">v1.1 Accepted</span></td>
              <td>JSON-RPC 2.0 を共通フォーマットに統一</td>
            </tr>
            <tr>
              <td><code>CAPSULE_SPEC.md</code></td>
              <td><span class="badge draft">v0.1 Draft</span></td>
              <td><code>capsule.toml</code> の必須構造（schema/runtime/targets）</td>
            </tr>
            <tr>
              <td><code>STORE_SPEC.md</code></td>
              <td><span class="badge plan">v0.1 Accepted</span></td>
              <td>Cloudflare Workers + D1 + R2 ベースの配布基盤</td>
            </tr>
          </tbody>
        </table>

        <h2 id="architecture-boundary">責務境界（Smart Build, Dumb Runtime）</h2>
        <p>
          現在の基本境界は次の3層です。
          <code>capsule-cli</code> がランタイム選択・IPC仲介を担い、
          <code>nacelle</code> は隔離とプロセス実行、
          <code>ato-desktop</code> はユーザー対話を担います。
        </p>

        <div class="concept-grid">
          <a href="./cli-reference.html" class="concept-card">
            <div class="icon bg-blue">
              <svg viewBox="0 0 24 24" fill="none" stroke="#3B82F6" stroke-width="1.5"><polyline points="4 17 10 11 4 5"/><line x1="12" y1="19" x2="20" y2="19"/></svg>
            </div>
            <h4>capsule-cli</h4>
            <p>Router / IPC Broker / packaging / signing / validate / install</p>
          </a>
          <a href="./core-concepts.html#ipc-roles" class="concept-card">
            <div class="icon bg-purple">
              <svg viewBox="0 0 24 24" fill="none" stroke="#8B5CF6" stroke-width="1.5"><rect width="20" height="14" x="2" y="3" rx="2"/><line x1="8" x2="16" y1="21" y2="21"/><line x1="12" x2="12" y1="17" y2="21"/></svg>
            </div>
            <h4>nacelle</h4>
            <p>Source runtime, supervisor, sandbox policy enforcement</p>
          </a>
          <a href="./future-roadmap.html#phase-v04" class="concept-card">
            <div class="icon bg-amber">
              <svg viewBox="0 0 24 24" fill="none" stroke="#F59E0B" stroke-width="1.5"><path d="M12 2a3 3 0 0 0-3 3v4a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/></svg>
            </div>
            <h4>ato-desktop</h4>
            <p>HostBridge, mode transition consent, dashboard UI</p>
          </a>
        </div>

        <h2 id="doc-map">ページ一覧</h2>
        <div class="concept-grid">
          <a href="./getting-started.html" class="concept-card">
            <div class="icon bg-green">
              <svg viewBox="0 0 24 24" fill="none" stroke="#10B981" stroke-width="1.5"><polyline points="4 17 10 11 4 5"/></svg>
            </div>
            <h4>Getting Started</h4>
            <p>最短で <code>capsule setup → new → validate → open</code> まで。</p>
          </a>
          <a href="./core-concepts.html" class="concept-card">
            <div class="icon bg-cyan">
              <svg viewBox="0 0 24 24" fill="none" stroke="#06B6D4" stroke-width="1.5"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/></svg>
            </div>
            <h4>Core Concepts</h4>
            <p>manifest / lifecycle / runtime routing / IPC役割分担。</p>
          </a>
          <a href="./cli-reference.html" class="concept-card">
            <div class="icon bg-blue">
              <svg viewBox="0 0 24 24" fill="none" stroke="#3B82F6" stroke-width="1.5"><rect x="3" y="3" width="18" height="18" rx="2"/><line x1="9" y1="9" x2="15" y2="15"/><line x1="15" y1="9" x2="9" y2="15"/></svg>
            </div>
            <h4>CLI Reference</h4>
            <p><code>capsule</code> の現行サブコマンドとPhase別機能。</p>
          </a>
          <a href="./publish-guideline.html" class="concept-card">
            <div class="icon bg-purple">
              <svg viewBox="0 0 24 24" fill="none" stroke="#8B5CF6" stroke-width="1.5"><path d="M21.2 8.4c.5.38.8.97.8 1.6v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V10a2 2 0 0 1 .8-1.6l8-6a2 2 0 0 1 2.4 0l8 6Z"/><path d="m22 10-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 10"/></svg>
            </div>
            <h4>Publish Guideline</h4>
            <p>署名付きアーティファクトの作成とStore公開フロー。</p>
          </a>
          <a href="./future-roadmap.html" class="concept-card">
            <div class="icon bg-amber">
              <svg viewBox="0 0 24 24" fill="none" stroke="#F59E0B" stroke-width="1.5"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
            </div>
            <h4>Future Roadmap</h4>
            <p>v0.3→v0.4 以降の実装優先順位。</p>
          </a>
        </div>

        <div class="nav-cards">
          <a href="./getting-started.html" class="nav-card next">
            <div>
              <div class="label">Next</div>
              <div class="title">Getting Started</div>
            </div>
            <svg class="arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="9 18 15 12 9 6"/>
            </svg>
          </a>
        </div>

        <p class="page-footer">Updated for specs as of 2026-02-07.</p>
      </article>
    </main>

    <!-- TOC Sidebar -->
    <aside class="toc-sidebar">
      <div class="toc-title">On this page</div>
      <nav>
        <a href="#how-to-read" class="toc-link">読み方</a>
        <a href="#spec-status" class="toc-link">仕様ステータス</a>
        <a href="#architecture-boundary" class="toc-link">責務境界</a>
        <a href="#doc-map" class="toc-link">ページ一覧</a>
      </nav>
    </aside>
  </div>

  <script src="./docs.js"></script>
</body>
</html>
